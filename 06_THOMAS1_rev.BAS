 'ON TIMER(1) GOSUB 10000
 'TIMER ON
REM SUBRUTINA DE THOMAS SOLUCION DE SISTEMAS TRIDIAGONALES
REM
REM A - DIAGONAL PRINCIPAL
REM B - DIAGONAL SUPERIOR
REM C - DIAGONAL INFERIOR
REM D - VECTOR TERMINO INDEPENDIENTE
REM X - VECTOR SOLUCION
REM N - ORDEN DE LA MATRIZ (NUMERO DE INCOGNITAS)
CLS
 PRINT :PRINT
 PRINT TAB(5);"SUBRUTINA DE THOMAS SOLUCION DE SISTEMAS TRIDIAGONALES"
 PRINT :PRINT
 INPUT "ORDEN DE LA MATRIZ -->";N
 DIM A(N),B(N),C(N),D(N),X(N),G(N),Q(N)
 FOR I=1 TO N
 PRINT "DIAGONAL PRINCIPAL ELEMENTO ";I;"-->";:INPUT A(I)
 NEXT I
 FOR I=1 TO N-1
 PRINT "DIAGONAL SUPERIOR ELEMENTO ";I;"-->";:INPUT B(I)
 NEXT I
 FOR I=2 TO N
 PRINT "DIAGONAL INFERIOR ELEMENTO  ";I;"-->";:INPUT C(I)
 NEXT I
 FOR I=1 TO N
 PRINT "VECTOR TERMINO INDEPENDIENTE";I;"-->";:INPUT D(I)
 NEXT I
 W1=A(1)
 G(1)=D(1)/W1
 FOR I=2 TO N
 Q(I-1)=B(I-1)/W1
 W1=A(I)-C(I)*Q(I-1)
 G(I)=(D(I)-C(I)*G(I-1))/W1
 NEXT I
 X(N)=G(N)
 FOR I=2 TO N
 J=N-I+1
 X(J)=G(J)-Q(J)*X(J+1)
 NEXT I
 CLS: PRINT TAB(20);"METODO DE THOMAS PARA LA SOLUCION "
 PRINT TAB(24);"DE MATRICES TRIDIAGONALES":PRINT :PRINT
 PRINT "LA MATRIZ DEL PROBLEMA TIENE LA SIGUIENTE FORMA:":PRINT :PRINT
 J=10
 PRINT TAB(J);"DI DP DS";TAB(42+N);"TERM.IND."
 FOR I=1 TO N
 PRINT TAB(J);C(I);A(I);B(I);TAB(44+N);D(I):J=J+3
 NEXT I
 PRINT :PRINT TAB(23);"Y EL VECTOR SOLUCION ES :":PRINT
 FOR I=1 TO N
 PRINT TAB(25);"X(";I;")-->";X(I)
 NEXT I
 END
 OLDROW=CSRLIN 'SALVA LA LINEA ACTUAL
 OLDCOL=POS(0) 'SALVA LA COLUMNA ACTUAL
 LOCATE 1,1:PRINT TIME$;
 LOCATE OLDROW,OLDCOL 'RESTAURA LINEA Y COLUMNA
 RETURN
